package main

import (
	"github.com/adrien3d/adventofcode/utils"
	"strings"
)

func mostAndLeastCommonRune(lines []string, i int) (uint8, uint8) {
	count0, count1 := 0, 0
	for _, line := range lines {
		if line[i] == '0' {
			count0++
		} else {
			count1++
		}
	}
	if count0 > count1 {
		return '0', '1'
	}
	return '1', '0'
}

func filter(lines []string, i int, mostCommon bool) string {
	if len(lines) == 1 {
		return lines[0]
	}
	most, least := mostAndLeastCommonRune(lines, i)
	comparator := least
	if mostCommon {
		comparator = most
	}
	filtered := make([]string, 0)
	for _, l := range lines {
		if l[i] == comparator {
			filtered = append(filtered, l)
		}
	}
	return filter(filtered, i+1, mostCommon)
}

func part1(input string, v bool) int {
	lines := strings.Split(input, "\n")
	gamma, epsilon := "", ""
	for i := 0; i < len(lines[0]); i++ {
		most, least := mostAndLeastCommonRune(lines, i)
		gamma += string(most)
		epsilon += string(least)
	}
	return utils.BinaryIntFromString(gamma) * utils.BinaryIntFromString(epsilon)
}

func part2(input string, v bool) int {
	lines := strings.Split(input, "\n")
	oxygen := filter(lines, 0, true)
	scrubber := filter(lines, 0, false)
	return utils.BinaryIntFromString(oxygen) * utils.BinaryIntFromString(scrubber)
}

func solve(input string, v bool) (part1TotalScore, part2TotalScore int) {
	part1TotalScore = part1(input, v)
	part2TotalScore = part2(input, v)
	return part1TotalScore, part2TotalScore
}

func main() {
	testInput := "00100\n11110\n10110\n10111\n10101\n01111\n00111\n11100\n10000\n11001\n00010\n01010"
	realInput := "010110011101\n101100111000\n100100000011\n111000010001\n001100010011\n010000111100\n001000100011\n001000100111\n010001111110\n111101001011\n011000101011\n111100111001\n100101111011\n101100110110\n101010111001\n001111000110\n001001101000\n101011001010\n011101111010\n011101001010\n011001000001\n100001010000\n111011001101\n000111110111\n010011001111\n000111011001\n111000010100\n101001100100\n110010001101\n111110101000\n011001100010\n110010110101\n010000001101\n100000000100\n110111011110\n110001100110\n001011110111\n110000011110\n110110101010\n101001100110\n010000001010\n100010100100\n101000111101\n111000001011\n000000100100\n100111010110\n010101011100\n011111010100\n100000001100\n111000011110\n010001001011\n100110000101\n001111111000\n110110111001\n011100010111\n111011101001\n100010101010\n110110100101\n101110110100\n000110111011\n100100000110\n111011111101\n111001111001\n110011101000\n100110111111\n000010100010\n011010010101\n110101100001\n000100100001\n000111010000\n001001000111\n110111110101\n000100010111\n110000000111\n101111011001\n001010001100\n000010001010\n001010111100\n110101111011\n100101001110\n000100101010\n101110001110\n110110010010\n110100000000\n001000101110\n110111110000\n001111011100\n111010000000\n101000100100\n010010111101\n110110111000\n001001100101\n010111110111\n010010001010\n000100011100\n001111110011\n000100101110\n011000010010\n111000000011\n001110100110\n110111110001\n011111110100\n010010001101\n011000100101\n110011011110\n100110101001\n100101010111\n010100010111\n101101110001\n011101110111\n110101011000\n001100101011\n110101100011\n110100101011\n000110101100\n101100110111\n111101011011\n000001100010\n010010101100\n110001001001\n111111100001\n110111010111\n101100001011\n000100011110\n000011101010\n101011000110\n101011110011\n010101001100\n100011111011\n111111001001\n000100111001\n011011011000\n100001110000\n000001011100\n101100101010\n011110110011\n111111101001\n000000100010\n111111001000\n001110000110\n100000100100\n001111001000\n001100101100\n001001100100\n010010100010\n110111101101\n111011100100\n110001111001\n101111101011\n000110100001\n010011111011\n110101010100\n100000111111\n110101010010\n110101100111\n001011111000\n100110011000\n100100010111\n101110101001\n110110110111\n001000011001\n100010111011\n000011010010\n111111100110\n011101011001\n101101011000\n101011101101\n101101100001\n111001000110\n000011010011\n110111001100\n000100010110\n010110001001\n000110110101\n100010001011\n000010001001\n111001100110\n011100101001\n111010010001\n000000011110\n101111000110\n111110001010\n100001111010\n000011110111\n011100000010\n011110000010\n010010001011\n110010000100\n011101011101\n000010110101\n010111111110\n010110000011\n111100101011\n101000111110\n011101110110\n101000100101\n000110010001\n010010001001\n001001011001\n100000101100\n000100011111\n101100001101\n100111000100\n011111000101\n011000000011\n100101100000\n100111011000\n111110011111\n001111001010\n000100100101\n001111010011\n000111100010\n001100010100\n111111001100\n110000100001\n000001011010\n001001101101\n101111101110\n110100111101\n010001110011\n000011000111\n011010100111\n111110101001\n111011111110\n010110100001\n001111000100\n100010110111\n101101100100\n111110011000\n000111101101\n010111001010\n000010110111\n011100100100\n001110100100\n000111101110\n100110110111\n110010110100\n001011000011\n100010100011\n111011100010\n011001001000\n111100000011\n011110110000\n110101011011\n001011110000\n110100110010\n100111011001\n101100010100\n001011010111\n011101011000\n110000001010\n101001010100\n010111011011\n001000010101\n001100111001\n010000001001\n101001000000\n101101100101\n110101111111\n011010001011\n111101111000\n111000110011\n000001000011\n110101110110\n111101100001\n000111000001\n000111000011\n100111101101\n100101001111\n101010000010\n001010001110\n000101110001\n001010000101\n101001001100\n001110100001\n110010011001\n111110000000\n100100010010\n010011011111\n001101010001\n000110101000\n010101101000\n000010100001\n010110010011\n000001001010\n100011100110\n101001010011\n001000011101\n000000110001\n100010000110\n010110010101\n100001110110\n010010010010\n010001000000\n110011001010\n010011011001\n111101101001\n000110111001\n001101110101\n000010110110\n000101001011\n000110000000\n001100001001\n100100111000\n110100010101\n000110001010\n110100110011\n011101001100\n001000000111\n010100101001\n100011011100\n000001100001\n000000001011\n110000100010\n001111110111\n111001011110\n011100010110\n100010011011\n100000010000\n111100100101\n100011011001\n000001101111\n100111010011\n011001100101\n010101101001\n110010110111\n100111111111\n111010111101\n000101000110\n100101001011\n000001011011\n000111001100\n011000101010\n101010000100\n101001100000\n100111101000\n101000001111\n010110010111\n000011010110\n011011010111\n010000101000\n011110010001\n101010001101\n110100011111\n010100011010\n101110100101\n101101111101\n001110011010\n100001110101\n011011011101\n011110011110\n110110001110\n110000000100\n101010011011\n101101111001\n011110101010\n001110000011\n101001110111\n101010110111\n000011001000\n011010100010\n000101101101\n000101000001\n000101011110\n010011101000\n011001111110\n101111000011\n111001010011\n001010000111\n001100000111\n000101101000\n001111100011\n000001000101\n010000010010\n010110011011\n011011010000\n111001010000\n100111010001\n011110001111\n010011000101\n010111111010\n001111001011\n000000001111\n011010011101\n111110000111\n000101001101\n111000110101\n100011101110\n011100011001\n010100010100\n011001000111\n011101000001\n110011111111\n100011010001\n101100100110\n001011001010\n110000000000\n111011101010\n111010110001\n100101110001\n011001110000\n001110010000\n111010001110\n010101100111\n000000100101\n100111001110\n001001001101\n100101110100\n101110000000\n101001111111\n101100001100\n011110011001\n010011100101\n000001100110\n010000111111\n011001010011\n011011000110\n000000010001\n001100010111\n000111100011\n011111001111\n010111101111\n101111011011\n110101110000\n011001001101\n001101011110\n000110011110\n110010000111\n111111100111\n010101001101\n111111000000\n001001011111\n010110000100\n111111000110\n010011000110\n010111101000\n111010111100\n111111111001\n011011000010\n001101110111\n000001111100\n111001101110\n111111101110\n000001111101\n001101011001\n100111000011\n110001010111\n011001010010\n011110111110\n110100111110\n011100001011\n010010111000\n001101100101\n111001111110\n101011001111\n011010010001\n011100101010\n000010111010\n000101100100\n110100110110\n010010110000\n110111010011\n010110000000\n111100010100\n010110110011\n001001111000\n110000101001\n101110010111\n011001111001\n101001100011\n111011101101\n100011000001\n010000011010\n000111111101\n111000101110\n000100001101\n101000100010\n001001011101\n100010010011\n011010100000\n101111100010\n000010000011\n101101011111\n111111000001\n110001000100\n011000111011\n111101011001\n010011111111\n010011001001\n000110010000\n001110101001\n111101000000\n011111011011\n010000011110\n101101011101\n110011110000\n001111100000\n011011010101\n110010011011\n001110010110\n010100011100\n000001111001\n111000101011\n101011010001\n101100101000\n111000001001\n010010000111\n001000101010\n101000010111\n000001101011\n001011111111\n010011111010\n111001011101\n101111001010\n010011011110\n001111010000\n011001101110\n101011100100\n010010011101\n101010010010\n011001000011\n101000000011\n110101001101\n011111000000\n010000010001\n111100011010\n101100011110\n000001010001\n110101101101\n010001000100\n100001001001\n100100000001\n101111101010\n111101010001\n001010011000\n100010101110\n000100010001\n010011010110\n110000111001\n100001100110\n100110110011\n000010111011\n010110001100\n010001100100\n101100001111\n001001101111\n000011111001\n010111010011\n011001101000\n111011001000\n110111000000\n111000011101\n011101100011\n010001100000\n100111101100\n001010110000\n000001101110\n101000111011\n100111110010\n100111001011\n110001110101\n000001111011\n001110101011\n000110001001\n010001000101\n111000101001\n000101010001\n011011011110\n110000011111\n011111111011\n011100111100\n101010011001\n101001111101\n101101001100\n010101101111\n100010001100\n100101111111\n010000111001\n110110000000\n111110111011\n011110101000\n000011011111\n100000011110\n001101110011\n010001010001\n010011000100\n110001110001\n110010011100\n011101110000\n100101011110\n010100100001\n110110101100\n100100111101\n100111011111\n011111101000\n101101000101\n000001110101\n010100011111\n101011000100\n001010011111\n110100010111\n010010101011\n100111100101\n011010101010\n011101111100\n110100100110\n011110001110\n110101011110\n100101100100\n001110001011\n001101110001\n010011110111\n111100000111\n100100101011\n110010101100\n001101110000\n001001110110\n101111000111\n011010000001\n110010100110\n111010110011\n100110001101\n101101101101\n101110011110\n001110001100\n010101000110\n100101001001\n110010101111\n100101001101\n111100000110\n010000011100\n001010011011\n100000110110\n001101010111\n100110100100\n000011101101\n100111000000\n111000100110\n000101110101\n110111000100\n011011100110\n110100110101\n110000010100\n000111011101\n010110101011\n100010011001\n011010110011\n101010010101\n101001110110\n110101111000\n110001111111\n101101110011\n101000010101\n101000010001\n011111110101\n010001000001\n100100111110\n100110101011\n101101100110\n111100100100\n010000010011\n100110100000\n000000000010\n110101000101\n000101000000\n000010101001\n100110100010\n011000110110\n100001001011\n100111011011\n011000001101\n011001100001\n101000010011\n010101010010\n100100110000\n110111100000\n011110111000\n001011010101\n111111000111\n111111010100\n001100011010\n000000111100\n101111100111\n111110110101\n001000001111\n011100011000\n001011111001\n110111010101\n010001111000\n001110110101\n011000101000\n011100101100\n000100000000\n100101101100\n101010101001\n100101000101\n100001101110\n011001011111\n011010101100\n110111011010\n110111010100\n010011000111\n101011010110\n001101001001\n110111011100\n111001001111\n010100100011\n101101111010\n101110110110\n111011100110\n000000101110\n001101100011\n110000001111\n100111010100\n000011111110\n100111001010\n111011111100\n111101001111\n001101111011\n110110010101\n100111110100\n100001110100\n111001100100\n000010110011\n011111111101\n010000100011\n001110011110\n111010101010\n000111111110\n100100000010\n100110101110\n100101111010\n001110011011\n011011111000\n011100010101\n000111001110\n100101011100\n001010101011\n001100110010\n100011000100\n101000101110\n110000111100\n110111001010\n011111011100\n011001011110\n001111010110\n100101100110\n111101100110\n001100001010\n001010010110\n000101001010\n001100110011\n111000110001\n001001010101\n000000001101\n011111001100\n101010011000\n100100011001\n001100100111\n101010110000\n101010100111\n011100101000\n010010010001\n001111011001\n111110100110\n101110110101\n101101110100\n101011111111\n000001111110\n110000000011\n000111010011\n001000000110\n010111001001\n000011001011\n110101110100\n110000110000\n111101001101\n101101011010\n001010110001\n101011100111\n011000000100\n111011111111\n110000010111\n110001011111\n011111001011\n011011000011\n011100111111\n110000101100\n001001110011\n000000111001\n010011101101\n111001010111\n100110000110\n001000001011\n110011100001\n001011010010\n111110110100\n000000111011\n111011101011\n000100110100\n110001100111\n011110100001\n101000000001\n100100101101\n000101010011\n000011000110\n100110111001\n011100101110\n000100100111\n011110011100\n110100001111\n100011001000\n000001001100\n010110101000\n100101000000\n111001101011\n111011010110\n000000011001\n110110000101\n001100000101\n010000100001\n100011101101\n010001000011\n011010111110\n010010101110\n000101110100\n000010010011\n010110010100\n001110011000\n101000001100\n110001101001\n100111110001\n101111100110\n000011011011\n010011010101\n111010111110\n000011101000\n010111001110\n100100011011\n010000010111\n111011100111\n110011010111\n010100100100\n010001011111\n001011111100\n110101001100\n010001011010\n010100110111\n100010000000\n101010110100\n100010111001\n000011000011\n001101101111\n000100101000\n100001101101\n110001000101\n110001100000\n111110001100\n101010010100\n001101111100\n011000010110\n011111000111\n111001010010\n100100011101\n111111111000\n111111111110\n000101110010\n010011111001\n000011110011\n101101000010\n010001001010\n000000000111\n001001110010\n110100011001\n011000001100\n111110001101\n100010000111\n101111100101\n110010000101\n010100110100\n001101011000\n100110111000\n100011100011\n110110011111\n111011011010\n000001011101\n010101010000\n111011010011\n111100110110\n001100010001\n110011101111\n110100111000\n010111011100\n100111101010\n110011000111\n110011011100\n110111111100\n011000000101\n011111001010\n010100011011\n001000101001\n101101011011\n101001010000\n000110111010\n000110100101\n010110000110\n100000100010\n000010000010\n110111111001\n001011010110\n100011010101\n011100000011\n111000111011\n010011001101\n111000100001\n001101010101\n001110010010\n100110011110\n001111101001\n000011111010\n110101000110\n101101000000\n010110100011\n011100111010\n011011110001\n000100111110\n000001011000\n010111101100\n100100110110\n101100011001\n011101011110\n100000100001\n011110100010\n000001010000\n101110010010\n010101111001\n100101100111\n010111100101\n111010110000\n001001010011\n100101000010\n011000110011\n101001101001\n110001011110\n010000111000\n000001010110\n010101011011\n011000010000\n101111010000\n011011110011\n001010011101\n100010111100\n011110011101\n010110100111\n110100011100\n010101001110\n001110111111\n011000110111\n101100001010\n011000010111\n100011010000\n011001110101\n100100001000\n100110000000\n000111111001\n011001010000\n011111010011\n001101011011\n001001111101\n000000101000\n110001101000\n101100001000\n011010011110\n001110000101\n010010100111\n101110111000\n000110110110\n011111100100\n101010000101\n101100100101\n101001111000\n001001101011\n110001111100\n011110111011\n010100111001\n011001111000\n101110100011\n111000111110\n000100000111\n100001101001\n110100001110\n000110011000\n001011001011\n010001111010\n100100100100\n100011010010\n001110001111\n000101101110\n111000101100\n111001110000"
	utils.Run(solve, testInput, true)
	utils.Run(solve, realInput, true)
}
